{% extends 'base.html' %}

{% block title %}IVF Cycles Overview{% endblock %}

{% block content %}
<h2 class="fw-bold">IVF Cycles Overview</h2>

<!-- Metrics -->
<div class="row g-3 my-3">
  <div class="col-md-3"><div class="card p-3 shadow-sm">Total Cycles: 1567</div></div>
  <div class="col-md-3"><div class="card p-3 shadow-sm">Active Cycles: 215</div></div>
  <div class="col-md-3"><div class="card p-3 shadow-sm">Upcoming: 58</div></div>
  <div class="col-md-3"><div class="card p-3 shadow-sm">Success Rate: 72.1%</div></div>
</div>

<!-- Chart -->
<div class="card p-3 shadow-sm">
    <canvas id="ivfStagesChart"></canvas>
</div>

<h4 class="mt-4">Recent IVF Cycles</h4>
<table class="table table-striped table-hover">
  <thead class="table-light">
    <tr>
      <th>Cycle_SK</th>
      <th>Case_ID</th>
      <th>Stage</th>
      <th>Status</th>
      <th>Outcome</th>
    </tr>
  </thead>
  <tbody id="cycleTableBody"></tbody>
</table>

<script>
fetch("/api/ivf_cycles")
  .then(res => res.json())
  .then(data => {
    const body = document.getElementById('cycleTableBody');
    data.forEach(row => {
      body.innerHTML += `
        <tr>
          <td>${row.cycle_sk}</td>
          <td>${row.case_id}</td>
          <td>${row.stage}</td>
          <td>${row.status}</td>
          <td>${row.outcome}</td>
        </tr>`;
    });
  });
</script>
{% endblock %}
